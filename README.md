# LSTM-WGAN-stock-market-forecasting
## Исследование данных
Для получения данных фондового рынка используется библиотека [yFinance](https://github.com/ranaroussi/yfinance). Эта библиотека разработана специально для загрузки соответствующей информации о конкретной акции с веб-страницы Yahoo Finance. Используя [yFinance](https://github.com/ranaroussi/yfinance), мы можем легко получить доступ к последним рыночным данным и включить их в модель.

Данные представленны в виде:
* Дата
* Цена открытия
* Цена закрытия
* Максимальная цена
* Минимальная цена
* Скорректированная цена закрытия
* Объём
Периодичность данных - 1 день. Временной отрезок ('2008-08-01') - ('2023-08-01'). Разбивка данных на train\test произведена в соотношении 0.8\0.2.
## Генерация новых признаков
В данной работе я использовал популярные индикаторы технического анализа, такие как:
* Exponential Moving Average(разновидность взвешенной скользящей средней, веса которой убывают экспоненциально)
* Moving Average Convergence/Divergence (индикатор схождения-расхождения скользящих средних)
* Relative Strength index (Индекс относительной силы)
* Average True Range
* upper and lower Bollinger Bands(индикатор, отражающий текущие отклонения цены)
* Relative Strength Value(индикатор используются в техническом анализе для определения условий перекупленности и перепроданности ценной бумаги)
* Компоненты преобразования Фурье - 3, 6, 9, 27, 81 и 100

Признаки извлекались с разными размерами окна в 7, 14, 21 дней.
Для отбора фичей, т.е. определения значимости признаков использовалась библиотека XGBoost. Пример отбора признаков: ![image](https://github.com/Dortp68/LSTM-WGAN-stock-market-forecasting/assets/53114070/c7eca5b4-6da9-4b90-a3d5-56c9cb2cf790)
Можно оставить любое желаемое количество признаков, рекомендованное количество - 10+
## Постановка задачи и трансформирование данных
Целевая переменная - цена закрытия. Задача предсказания цен рынка идентична задаче прогнозирования временных рядов. Необходимо на основе прошлого временного ряда длиной N спрогнозировать значения следующих M отрезков. Поэтому данные нужно трансформировать, пройдясь по ним скользящим окном длиной N.
![image](https://github.com/Dortp68/LSTM-WGAN-stock-market-forecasting/assets/53114070/3cc8c8bf-1896-4803-9c4a-504479fdc24a)
Обычно в таких задачах хорошо себя показывают рекуррентные сети, в частности LSTM. В обзорной статье [A Survey of Forex and Stock Price Prediction Using Deep Learning](https://www.mdpi.com/2571-5577/4/1/9) приведна статистика свежих исследований в этом направлении, больше всего работ связанных с рекуррентными и свёрточными нейросетями. Также в статье показано, что LSTM показывают неплохие результаты. В связи с этим в первой baseline попытке, я принял решение использовать сеть долгой краткосрочной памяти, с одномерным входом, то есть единственным признаком будет цена закрытия за прошлые n дней. Предсказываемое значение - цена закрытия на 1 день вперёд. Результаты приведены в [ноутбуке](https://github.com/Dortp68/LSTM-WGAN-stock-market-forecasting/blob/main/Baseline.ipynb).
## Постановка задачи и трансформирование данных
